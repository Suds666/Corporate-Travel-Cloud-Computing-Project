{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\strik\\\\Downloads\\\\cafecoffee\\\\corporate-travel\\\\frontend\\\\src\\\\components\\\\Seats.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport './Seats.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst IMAGE_SOURCES = ['/images/man-standing-up-with-arms-in-front.png', '/images/person.png', '/images/man-standing-up.png', '/images/standing-man-silhouette-holding-a-disc.png'];\nconst GAME_QUEUE_TARGET = 6;\nconst MIN_SPAWN_DELAY = 1800;\nconst MAX_SPAWN_DELAY = 4000;\nconst MIN_FALL_DURATION = 1000;\nconst MAX_FALL_DURATION = 3000;\nfunction Seats() {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    user,\n    flights,\n    origin,\n    destination,\n    airline\n  } = location.state || {};\n  const [selectedSeat, setSelectedSeat] = useState(null);\n  const [fallingItems, setFallingItems] = useState([]);\n  const [appearanceOrder, setAppearanceOrder] = useState([]);\n  const [correctlyQueued, setCorrectlyQueued] = useState([]);\n  const [isDraggingOverQueue, setIsDraggingOverQueue] = useState(false);\n  const [incorrectDropFlash, setIncorrectDropFlash] = useState(false);\n\n  // --- Game State Control ---\n  const [hasUserStartedGame, setHasUserStartedGame] = useState(false);\n  const [isGameActive, setIsGameActive] = useState(false);\n  const [hasGameBeenWon, setHasGameBeenWon] = useState(false);\n  // ---\n\n  const nextItemId = useRef(0);\n  const spawnTimeoutRef = useRef(null);\n\n  // --- Spawn Logic (mostly unchanged, but relies on useEffect to start) ---\n  const spawnItem = useCallback(() => {\n    // Double check conditions just in case, though useEffect should control entry\n    if (!isGameActive || hasGameBeenWon || fallingItems.length > 15) {\n      clearTimeout(spawnTimeoutRef.current); // Ensure timeout is cleared if conditions fail\n      return;\n    }\n    const id = nextItemId.current++;\n    const src = IMAGE_SOURCES[Math.floor(Math.random() * IMAGE_SOURCES.length)];\n    const duration = Math.random() * (MAX_FALL_DURATION - MIN_FALL_DURATION) + MIN_FALL_DURATION;\n    const left = Math.random() * 95;\n    const newItem = {\n      id,\n      src,\n      duration,\n      left,\n      startTime: Date.now()\n    };\n    setFallingItems(prev => [...prev, newItem]);\n    if (correctlyQueued.length < GAME_QUEUE_TARGET) {\n      setAppearanceOrder(prev => [...prev, id]);\n    }\n    setTimeout(() => {\n      setFallingItems(prev => prev.filter(item => item.id !== id));\n    }, duration);\n\n    // Schedule next spawn ONLY if game should still be running\n    if (isGameActive && !hasGameBeenWon) {\n      const nextDelay = Math.random() * (MAX_SPAWN_DELAY - MIN_SPAWN_DELAY) + MIN_SPAWN_DELAY;\n      // Clear previous timeout before setting a new one (safer)\n      clearTimeout(spawnTimeoutRef.current);\n      spawnTimeoutRef.current = setTimeout(spawnItem, nextDelay);\n    } else {\n      clearTimeout(spawnTimeoutRef.current); // Clear if game stopped/won\n    }\n    // Added isGameActive and hasGameBeenWon here. spawnItem needs access to the latest state\n  }, [fallingItems.length, correctlyQueued.length, isGameActive, hasGameBeenWon]); // Keep dependencies\n\n  // --- Effect to Start/Stop Spawning ---\n  useEffect(() => {\n    // Start spawning only if the game is marked active and not yet won\n    if (isGameActive && !hasGameBeenWon) {\n      // Clear any residual timeout before starting anew\n      clearTimeout(spawnTimeoutRef.current);\n      // Start the first spawn\n      spawnTimeoutRef.current = setTimeout(spawnItem, MIN_SPAWN_DELAY);\n      console.log(\"Game Active: Starting spawn loop.\"); // Debug log\n    } else {\n      // If game becomes inactive OR is won, clear the timeout to stop spawning\n      clearTimeout(spawnTimeoutRef.current);\n      console.log(\"Game Inactive or Won: Clearing spawn loop.\"); // Debug log\n    }\n\n    // Cleanup function: This runs when the component unmounts OR\n    // when the dependencies (isGameActive, hasGameBeenWon, spawnItem) change *before* the effect runs again.\n    return () => {\n      console.log(\"Effect cleanup: Clearing timeout.\"); // Debug log\n      clearTimeout(spawnTimeoutRef.current);\n    };\n    // spawnItem is included because it's called inside the effect.\n    // Its own useCallback dependencies ensure it updates correctly.\n  }, [isGameActive, hasGameBeenWon, spawnItem]);\n\n  // --- Game Control Functions ---\n  const startGame = () => {\n    if (!user || !flights || flights.length === 0 || hasUserStartedGame) return;\n    console.log(\"Starting Game...\"); // Debug log\n    setCorrectlyQueued([]);\n    setAppearanceOrder([]);\n    setFallingItems([]);\n    setHasGameBeenWon(false);\n    setIncorrectDropFlash(false); // Reset flash\n    nextItemId.current = 0;\n\n    // Set flags - the useEffect above will react to these changes\n    setHasUserStartedGame(true);\n    setIsGameActive(true); // This state change triggers the useEffect\n  };\n  const handleDragStart = useCallback((e, id, src) => {\n    if (!isGameActive || hasGameBeenWon) {\n      e.preventDefault();\n      return;\n    }\n    e.dataTransfer.setData(\"application/json\", JSON.stringify({\n      id,\n      src\n    }));\n    e.target.style.opacity = 0.5;\n  }, [isGameActive, hasGameBeenWon]);\n  const handleDragEnd = e => {\n    // Check if target still exists before setting opacity\n    if (e.target) {\n      e.target.style.opacity = 1;\n    }\n  };\n  const handleDragOver = e => {\n    if (isGameActive && !hasGameBeenWon) {\n      e.preventDefault();\n      setIsDraggingOverQueue(true);\n    }\n  };\n  const handleDragLeave = () => {\n    setIsDraggingOverQueue(false);\n  };\n  const handleDrop = e => {\n    if (!isGameActive || hasGameBeenWon) return;\n    e.preventDefault();\n    setIsDraggingOverQueue(false);\n    setIncorrectDropFlash(false);\n    let data;\n    try {\n      data = JSON.parse(e.dataTransfer.getData(\"application/json\"));\n    } catch (error) {\n      console.error(\"Failed to parse drag data:\", error);\n      return; // Exit if data is invalid\n    }\n    const {\n      id,\n      src\n    } = data;\n    if (correctlyQueued.length >= appearanceOrder.length || id !== appearanceOrder[correctlyQueued.length]) {\n      console.log(\"Incorrect Drop!\"); // Debug log\n      setIncorrectDropFlash(true);\n      setIsGameActive(false); // Stop game logic - this triggers useEffect cleanup\n      // No longer need explicit clearTimeout here, useEffect handles it\n      setTimeout(() => {\n        window.location.reload();\n      }, 500);\n    } else {\n      console.log(\"Correct Drop!\"); // Debug log\n      setCorrectlyQueued(prev => {\n        const updated = [...prev, {\n          id,\n          src\n        }];\n        if (updated.length === GAME_QUEUE_TARGET) {\n          console.log(\"Game Won!\"); // Debug log\n          // Mark as won and inactive - useEffect will handle stopping the spawn loop\n          setIsGameActive(false);\n          setHasGameBeenWon(true);\n          setFallingItems([]); // Clear remaining items immediately on win\n        }\n        return updated;\n      });\n      setFallingItems(prev => prev.filter(item => item.id !== id));\n    }\n  };\n\n  // --- Render Logic ---\n\n  if (!user) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"seats-pg-error-message\",\n    children: \"\\u274C Error: User not found.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 188,\n    columnNumber: 21\n  }, this);\n  if (!flights || flights.length === 0) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"seats-pg-warning-message\",\n    children: \"\\u26A0\\uFE0F No flight data.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 48\n  }, this);\n  const flight = flights[0];\n  const seatRows = 6;\n  const seatCols = ['A', 'B', 'C', 'D'];\n  const allowedRows = user.role_id === 1 ? [1, 2] : [3, 4, 5, 6];\n  const renderSeatMap = () => {\n    // ... (renderSeatMap function remains the same)\n    return Array.from({\n      length: seatRows\n    }, (_, i) => {\n      const row = i + 1;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seats-pg-seat-row\",\n        children: seatCols.map(col => {\n          const id = `${row}${col}`;\n          const allowed = allowedRows.includes(row);\n          const selected = selectedSeat === id;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `seats-pg-seat-button ${selected ? 'selected' : allowed ? 'allowed' : 'disallowed'}`,\n            onClick: () => allowed && setSelectedSeat(id),\n            disabled: !allowed,\n            children: id\n          }, id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 15\n          }, this);\n        })\n      }, row, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this);\n    });\n  };\n  const handleProceedToVisa = () => {\n    if (!selectedSeat || !flight || hasUserStartedGame && !hasGameBeenWon) return;\n    console.log(\"Proceeding to Visa Upload...\"); // Debug log\n    // Ensure game is fully stopped if proceeding\n    setIsGameActive(false); // Trigger useEffect cleanup if needed\n    clearTimeout(spawnTimeoutRef.current); // Explicit clear just in case\n\n    navigate('/upload-visa', {\n      state: {\n        user,\n        pendingBooking: {\n          employee_id: user.id,\n          flight_id: flight.id,\n          seat_number: selectedSeat,\n          origin,\n          destination,\n          airline\n        }\n      }\n    });\n  };\n  const proceedDisabled = !selectedSeat || hasUserStartedGame && !hasGameBeenWon;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"seats-pg-body\",\n    children: [hasUserStartedGame && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seats-pg-falling-items-container\",\n        children: fallingItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n          draggable: isGameActive && !hasGameBeenWon,\n          onDragStart: e => handleDragStart(e, item.id, item.src),\n          onDragEnd: handleDragEnd,\n          className: \"seats-pg-falling-item\",\n          style: {\n            backgroundImage: `url(${item.src})`,\n            left: `${item.left}%`,\n            animationDuration: `${item.duration}ms`,\n            cursor: isGameActive && !hasGameBeenWon ? 'grab' : 'default',\n            opacity: isGameActive && !hasGameBeenWon ? 1 : 0.6\n          }\n        }, item.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `\n                seats-pg-game-queue-container\n                ${isDraggingOverQueue ? 'drag-over' : ''}\n                ${incorrectDropFlash ? 'incorrect-drop' : ''}\n                ${hasGameBeenWon ? 'game-won' : ''}\n             `,\n        onDragOver: handleDragOver,\n        onDrop: handleDrop,\n        onDragLeave: handleDragLeave,\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [\"Queue: \", correctlyQueued.length, \"/\", GAME_QUEUE_TARGET, hasGameBeenWon && \" (Completed!)\", incorrectDropFlash && \" (Incorrect!)\", \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seats-pg-game-queue\",\n          children: [correctlyQueued.map((item, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seats-pg-queued-item\",\n            style: {\n              backgroundImage: `url(${item.src})`\n            }\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 17\n          }, this)), Array.from({\n            length: Math.max(0, GAME_QUEUE_TARGET - correctlyQueued.length)\n          }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seats-pg-queued-item placeholder\"\n          }, i + correctlyQueued.length, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seats-pg-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"seats-pg-header\",\n        children: \"Choose Your Seat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"seats-pg-flight-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Flight:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this), \" \", airline, \" | \", origin, \" \\u279C \", destination]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), !hasUserStartedGame && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startGame,\n        className: \"seats-pg-start-game-button\",\n        children: \"Play Optional Queue Game?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 11\n      }, this), renderSeatMap(), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"seats-pg-proceed-button\",\n        onClick: handleProceedToVisa,\n        disabled: proceedDisabled,\n        children: \"Proceed to Upload Visa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), proceedDisabled && hasUserStartedGame && !hasGameBeenWon && !incorrectDropFlash && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"seats-pg-warning-message\",\n        children: \"Complete the queue game to proceed, or refresh to skip/retry.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 13\n      }, this), proceedDisabled && !selectedSeat && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"seats-pg-warning-message\",\n        children: \"Please select an available seat.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 248,\n    columnNumber: 5\n  }, this);\n}\n_s(Seats, \"UW+9jbXuey1vKBxdp+71bzGH0Sw=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = Seats;\nexport default Seats;\nvar _c;\n$RefreshReg$(_c, \"Seats\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useLocation","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","IMAGE_SOURCES","GAME_QUEUE_TARGET","MIN_SPAWN_DELAY","MAX_SPAWN_DELAY","MIN_FALL_DURATION","MAX_FALL_DURATION","Seats","_s","location","navigate","user","flights","origin","destination","airline","state","selectedSeat","setSelectedSeat","fallingItems","setFallingItems","appearanceOrder","setAppearanceOrder","correctlyQueued","setCorrectlyQueued","isDraggingOverQueue","setIsDraggingOverQueue","incorrectDropFlash","setIncorrectDropFlash","hasUserStartedGame","setHasUserStartedGame","isGameActive","setIsGameActive","hasGameBeenWon","setHasGameBeenWon","nextItemId","spawnTimeoutRef","spawnItem","length","clearTimeout","current","id","src","Math","floor","random","duration","left","newItem","startTime","Date","now","prev","setTimeout","filter","item","nextDelay","console","log","startGame","handleDragStart","e","preventDefault","dataTransfer","setData","JSON","stringify","target","style","opacity","handleDragEnd","handleDragOver","handleDragLeave","handleDrop","data","parse","getData","error","window","reload","updated","className","children","fileName","_jsxFileName","lineNumber","columnNumber","flight","seatRows","seatCols","allowedRows","role_id","renderSeatMap","Array","from","_","i","row","map","col","allowed","includes","selected","onClick","disabled","handleProceedToVisa","pendingBooking","employee_id","flight_id","seat_number","proceedDisabled","draggable","onDragStart","onDragEnd","backgroundImage","animationDuration","cursor","onDragOver","onDrop","onDragLeave","idx","max","_c","$RefreshReg$"],"sources":["C:/Users/strik/Downloads/cafecoffee/corporate-travel/frontend/src/components/Seats.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport './Seats.css';\r\n\r\nconst IMAGE_SOURCES = [\r\n  '/images/man-standing-up-with-arms-in-front.png',\r\n  '/images/person.png',\r\n  '/images/man-standing-up.png',\r\n  '/images/standing-man-silhouette-holding-a-disc.png',\r\n];\r\nconst GAME_QUEUE_TARGET = 6;\r\nconst MIN_SPAWN_DELAY = 1800;\r\nconst MAX_SPAWN_DELAY = 4000;\r\nconst MIN_FALL_DURATION = 1000;\r\nconst MAX_FALL_DURATION = 3000;\r\n\r\nfunction Seats() {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { user, flights, origin, destination, airline } = location.state || {};\r\n\r\n  const [selectedSeat, setSelectedSeat] = useState(null);\r\n  const [fallingItems, setFallingItems] = useState([]);\r\n  const [appearanceOrder, setAppearanceOrder] = useState([]);\r\n  const [correctlyQueued, setCorrectlyQueued] = useState([]);\r\n  const [isDraggingOverQueue, setIsDraggingOverQueue] = useState(false);\r\n  const [incorrectDropFlash, setIncorrectDropFlash] = useState(false);\r\n\r\n  // --- Game State Control ---\r\n  const [hasUserStartedGame, setHasUserStartedGame] = useState(false);\r\n  const [isGameActive, setIsGameActive] = useState(false);\r\n  const [hasGameBeenWon, setHasGameBeenWon] = useState(false);\r\n  // ---\r\n\r\n  const nextItemId = useRef(0);\r\n  const spawnTimeoutRef = useRef(null);\r\n\r\n  // --- Spawn Logic (mostly unchanged, but relies on useEffect to start) ---\r\n  const spawnItem = useCallback(() => {\r\n    // Double check conditions just in case, though useEffect should control entry\r\n    if (!isGameActive || hasGameBeenWon || fallingItems.length > 15) {\r\n      clearTimeout(spawnTimeoutRef.current); // Ensure timeout is cleared if conditions fail\r\n      return;\r\n    }\r\n\r\n    const id = nextItemId.current++;\r\n    const src = IMAGE_SOURCES[Math.floor(Math.random() * IMAGE_SOURCES.length)];\r\n    const duration = Math.random() * (MAX_FALL_DURATION - MIN_FALL_DURATION) + MIN_FALL_DURATION;\r\n    const left = Math.random() * 95;\r\n\r\n    const newItem = { id, src, duration, left, startTime: Date.now() };\r\n    setFallingItems(prev => [...prev, newItem]);\r\n\r\n    if (correctlyQueued.length < GAME_QUEUE_TARGET) {\r\n      setAppearanceOrder(prev => [...prev, id]);\r\n    }\r\n\r\n    setTimeout(() => {\r\n      setFallingItems(prev => prev.filter(item => item.id !== id));\r\n    }, duration);\r\n\r\n    // Schedule next spawn ONLY if game should still be running\r\n    if (isGameActive && !hasGameBeenWon) {\r\n        const nextDelay = Math.random() * (MAX_SPAWN_DELAY - MIN_SPAWN_DELAY) + MIN_SPAWN_DELAY;\r\n        // Clear previous timeout before setting a new one (safer)\r\n        clearTimeout(spawnTimeoutRef.current);\r\n        spawnTimeoutRef.current = setTimeout(spawnItem, nextDelay);\r\n    } else {\r\n         clearTimeout(spawnTimeoutRef.current); // Clear if game stopped/won\r\n    }\r\n    // Added isGameActive and hasGameBeenWon here. spawnItem needs access to the latest state\r\n  }, [fallingItems.length, correctlyQueued.length, isGameActive, hasGameBeenWon]); // Keep dependencies\r\n\r\n  // --- Effect to Start/Stop Spawning ---\r\n  useEffect(() => {\r\n    // Start spawning only if the game is marked active and not yet won\r\n    if (isGameActive && !hasGameBeenWon) {\r\n      // Clear any residual timeout before starting anew\r\n      clearTimeout(spawnTimeoutRef.current);\r\n      // Start the first spawn\r\n      spawnTimeoutRef.current = setTimeout(spawnItem, MIN_SPAWN_DELAY);\r\n      console.log(\"Game Active: Starting spawn loop.\"); // Debug log\r\n    } else {\r\n      // If game becomes inactive OR is won, clear the timeout to stop spawning\r\n      clearTimeout(spawnTimeoutRef.current);\r\n      console.log(\"Game Inactive or Won: Clearing spawn loop.\"); // Debug log\r\n    }\r\n\r\n    // Cleanup function: This runs when the component unmounts OR\r\n    // when the dependencies (isGameActive, hasGameBeenWon, spawnItem) change *before* the effect runs again.\r\n    return () => {\r\n      console.log(\"Effect cleanup: Clearing timeout.\"); // Debug log\r\n      clearTimeout(spawnTimeoutRef.current);\r\n    };\r\n  // spawnItem is included because it's called inside the effect.\r\n  // Its own useCallback dependencies ensure it updates correctly.\r\n  }, [isGameActive, hasGameBeenWon, spawnItem]);\r\n\r\n  // --- Game Control Functions ---\r\n  const startGame = () => {\r\n    if (!user || !flights || flights.length === 0 || hasUserStartedGame) return;\r\n\r\n    console.log(\"Starting Game...\"); // Debug log\r\n    setCorrectlyQueued([]);\r\n    setAppearanceOrder([]);\r\n    setFallingItems([]);\r\n    setHasGameBeenWon(false);\r\n    setIncorrectDropFlash(false); // Reset flash\r\n    nextItemId.current = 0;\r\n\r\n    // Set flags - the useEffect above will react to these changes\r\n    setHasUserStartedGame(true);\r\n    setIsGameActive(true); // This state change triggers the useEffect\r\n  };\r\n\r\n  const handleDragStart = useCallback((e, id, src) => {\r\n    if (!isGameActive || hasGameBeenWon) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n    e.dataTransfer.setData(\"application/json\", JSON.stringify({ id, src }));\r\n    e.target.style.opacity = 0.5;\r\n  }, [isGameActive, hasGameBeenWon]);\r\n\r\n  const handleDragEnd = (e) => {\r\n    // Check if target still exists before setting opacity\r\n    if (e.target) {\r\n         e.target.style.opacity = 1;\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (isGameActive && !hasGameBeenWon) {\r\n        e.preventDefault();\r\n        setIsDraggingOverQueue(true);\r\n    }\r\n  };\r\n\r\n  const handleDragLeave = () => {\r\n    setIsDraggingOverQueue(false);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    if (!isGameActive || hasGameBeenWon) return;\r\n\r\n    e.preventDefault();\r\n    setIsDraggingOverQueue(false);\r\n    setIncorrectDropFlash(false);\r\n\r\n    let data;\r\n    try {\r\n        data = JSON.parse(e.dataTransfer.getData(\"application/json\"));\r\n    } catch (error) {\r\n        console.error(\"Failed to parse drag data:\", error);\r\n        return; // Exit if data is invalid\r\n    }\r\n\r\n    const { id, src } = data;\r\n\r\n    if (correctlyQueued.length >= appearanceOrder.length || id !== appearanceOrder[correctlyQueued.length]) {\r\n      console.log(\"Incorrect Drop!\"); // Debug log\r\n      setIncorrectDropFlash(true);\r\n      setIsGameActive(false); // Stop game logic - this triggers useEffect cleanup\r\n      // No longer need explicit clearTimeout here, useEffect handles it\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 500);\r\n\r\n    } else {\r\n      console.log(\"Correct Drop!\"); // Debug log\r\n      setCorrectlyQueued(prev => {\r\n        const updated = [...prev, { id, src }];\r\n        if (updated.length === GAME_QUEUE_TARGET) {\r\n          console.log(\"Game Won!\"); // Debug log\r\n          // Mark as won and inactive - useEffect will handle stopping the spawn loop\r\n          setIsGameActive(false);\r\n          setHasGameBeenWon(true);\r\n          setFallingItems([]); // Clear remaining items immediately on win\r\n        }\r\n        return updated;\r\n      });\r\n      setFallingItems(prev => prev.filter(item => item.id !== id));\r\n    }\r\n  };\r\n\r\n  // --- Render Logic ---\r\n\r\n  if (!user) return <p className=\"seats-pg-error-message\">❌ Error: User not found.</p>;\r\n  if (!flights || flights.length === 0) return <p className=\"seats-pg-warning-message\">⚠️ No flight data.</p>;\r\n\r\n  const flight = flights[0];\r\n  const seatRows = 6;\r\n  const seatCols = ['A', 'B', 'C', 'D'];\r\n  const allowedRows = user.role_id === 1 ? [1, 2] : [3, 4, 5, 6];\r\n\r\n  const renderSeatMap = () => {\r\n    // ... (renderSeatMap function remains the same)\r\n    return Array.from({ length: seatRows }, (_, i) => {\r\n      const row = i + 1;\r\n      return (\r\n        <div key={row} className=\"seats-pg-seat-row\">\r\n          {seatCols.map(col => {\r\n            const id = `${row}${col}`;\r\n            const allowed = allowedRows.includes(row);\r\n            const selected = selectedSeat === id;\r\n            return (\r\n              <button\r\n                key={id}\r\n                className={`seats-pg-seat-button ${selected ? 'selected' : allowed ? 'allowed' : 'disallowed'}`}\r\n                onClick={() => allowed && setSelectedSeat(id)}\r\n                disabled={!allowed}\r\n              >\r\n                {id}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  const handleProceedToVisa = () => {\r\n    if (!selectedSeat || !flight || (hasUserStartedGame && !hasGameBeenWon)) return;\r\n\r\n    console.log(\"Proceeding to Visa Upload...\"); // Debug log\r\n    // Ensure game is fully stopped if proceeding\r\n    setIsGameActive(false); // Trigger useEffect cleanup if needed\r\n    clearTimeout(spawnTimeoutRef.current); // Explicit clear just in case\r\n\r\n    navigate('/upload-visa', {\r\n      state: {\r\n        user,\r\n        pendingBooking: {\r\n          employee_id: user.id,\r\n          flight_id: flight.id,\r\n          seat_number: selectedSeat,\r\n          origin,\r\n          destination,\r\n          airline,\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const proceedDisabled = !selectedSeat || (hasUserStartedGame && !hasGameBeenWon);\r\n\r\n  return (\r\n    <div className=\"seats-pg-body\">\r\n      {/* Conditional rendering of game UI */}\r\n      {hasUserStartedGame && (\r\n        <>\r\n          <div className=\"seats-pg-falling-items-container\">\r\n            {fallingItems.map(item => (\r\n              <div\r\n                key={item.id}\r\n                draggable={isGameActive && !hasGameBeenWon}\r\n                onDragStart={(e) => handleDragStart(e, item.id, item.src)}\r\n                onDragEnd={handleDragEnd}\r\n                className=\"seats-pg-falling-item\"\r\n                style={{\r\n                  backgroundImage: `url(${item.src})`,\r\n                  left: `${item.left}%`,\r\n                  animationDuration: `${item.duration}ms`,\r\n                  cursor: (isGameActive && !hasGameBeenWon) ? 'grab' : 'default',\r\n                  opacity: (isGameActive && !hasGameBeenWon) ? 1 : 0.6,\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n\r\n          <div\r\n            className={`\r\n                seats-pg-game-queue-container\r\n                ${isDraggingOverQueue ? 'drag-over' : ''}\r\n                ${incorrectDropFlash ? 'incorrect-drop' : ''}\r\n                ${hasGameBeenWon ? 'game-won' : ''}\r\n             `}\r\n            onDragOver={handleDragOver}\r\n            onDrop={handleDrop}\r\n            onDragLeave={handleDragLeave}\r\n          >\r\n            <h4>\r\n                Queue: {correctlyQueued.length}/{GAME_QUEUE_TARGET}\r\n                {hasGameBeenWon && \" (Completed!)\"}\r\n                {incorrectDropFlash && \" (Incorrect!)\"} {/* Show briefly before reload */}\r\n            </h4>\r\n            <div className=\"seats-pg-game-queue\">\r\n              {correctlyQueued.map((item, idx) => (\r\n                <div key={idx} className=\"seats-pg-queued-item\" style={{ backgroundImage: `url(${item.src})` }} />\r\n              ))}\r\n              {Array.from({ length: Math.max(0, GAME_QUEUE_TARGET - correctlyQueued.length) }).map((_, i) => (\r\n                <div key={i + correctlyQueued.length} className=\"seats-pg-queued-item placeholder\" />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Main Content */}\r\n      <div className=\"seats-pg-container\">\r\n        <h3 className=\"seats-pg-header\">Choose Your Seat</h3>\r\n        <p className=\"seats-pg-flight-info\">\r\n          <strong>Flight:</strong> {airline} | {origin} ➜ {destination}\r\n        </p>\r\n\r\n        {!hasUserStartedGame && (\r\n          <button onClick={startGame} className=\"seats-pg-start-game-button\">\r\n            Play Optional Queue Game?\r\n          </button>\r\n        )}\r\n\r\n        {renderSeatMap()}\r\n\r\n        <button\r\n          className=\"seats-pg-proceed-button\"\r\n          onClick={handleProceedToVisa}\r\n          disabled={proceedDisabled}\r\n        >\r\n          Proceed to Upload Visa\r\n        </button>\r\n        {/* Feedback messages */}\r\n        {proceedDisabled && hasUserStartedGame && !hasGameBeenWon && !incorrectDropFlash && (\r\n            <p className=\"seats-pg-warning-message\">Complete the queue game to proceed, or refresh to skip/retry.</p>\r\n        )}\r\n         {proceedDisabled && !selectedSeat && (\r\n            <p className=\"seats-pg-warning-message\">Please select an available seat.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Seats;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}